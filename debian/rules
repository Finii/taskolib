#!/usr/bin/make -f
#
# File:   debian/rules
#

LIBNO=$(shell grep LIBNO LIBNO | sed -e 's/LIBNO.*=//' -e 's/[[:space:]]//g')

%:
	dh $@

override_dh_auto_configure:
	debian/check_control
	debian/check_changelog
	CC=/usr/bin/gcc CXX=/usr/bin/c++ meson setup build/${DEB_BUILD_GNU_TYPE} \
		--buildtype=debugoptimized \
		--prefix=/export/doocs \
		--libdir=lib \
		--includedir=lib/include \
		--wrap-mode=nofallback \
		--build.pkg-config-path=/export/doocs/lib/pkgconfig \
		-Dversion=${LIBNO}

override_dh_auto_build:
	ninja -C build/${DEB_BUILD_GNU_TYPE}

override_dh_auto_install:
	DESTDIR=`pwd`/debian/tmp ninja -C build/${DEB_BUILD_GNU_TYPE} install

override_dh_auto_test:
	ninja -C build/${DEB_BUILD_GNU_TYPE} test

override_dh_auto_clean:
	if [ -d "build/${DEB_BUILD_GNU_TYPE}" ]; then \
		rm -R build/${DEB_BUILD_GNU_TYPE}; \
	fi

override_dh_strip:
# Do not strip library symbols
